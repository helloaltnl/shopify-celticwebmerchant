{% comment %}
  Block: Marketing Grid
  Flexible grid or slider layout for showcasing mixed content types
  
  Features:
  - Grid layouts (3, 4, 5 items with creative asymmetric layouts)
  - Slider/carousel mode
  - Multiple content types: banners, videos, products, collections
  - Design variants: blue, red, green
  
  Blocks:
  - banner: Image + text banner
  - video: YouTube/Vimeo video with cover
  - product: Product card
  - collection: Collection card
{% endcomment %}

<section class="marketing-grid-section has-bg-{{ section.settings.background_color }}" id="marketing-grid-{{ section.id }}">
  <div class="marketing-grid-section__inner alignwide is-constrained">
    {%- if section.settings.heading != blank or section.settings.subtext != blank -%}
      <div class="marketing-grid-section__header">
        {%- if section.settings.heading != blank -%}
          <h2 class="marketing-grid-section__title">{{ section.settings.heading }}</h2>
        {%- endif -%}
        {%- if section.settings.subtext != blank -%}
          <p class="marketing-grid-section__subtitle">{{ section.settings.subtext }}</p>
        {%- endif -%}
      </div>
    {%- endif -%}
    
    <div 
      class="marketing-grid is-{{ section.settings.view }} has-items-{{ section.blocks.size }} {% unless section.settings.enable_gaps %}has-no-gaps{% endunless %}" 
      {{ section.shopify_attributes }}
    >
      {%- for block in section.blocks -%}
        <div class="marketing-grid-item" {{ block.shopify_attributes }}>
          {%- case block.type -%}
            
            {%- when 'banner' -%}
              {%- render 'html-marketing-grid-banner',
                image: block.settings.image,
                label: block.settings.label,
                heading: block.settings.heading,
                text: block.settings.text,
                link_url: block.settings.link_url,
                design: block.settings.design,
                block_id: block.id
              -%}
            
            {%- when 'video' -%}
              {%- render 'html-marketing-grid-video',
                video_url: block.settings.video_url,
                cover_image: block.settings.cover_image,
                description: block.settings.description,
                design: block.settings.design,
                block_id: block.id
              -%}
            
            {%- when 'product' -%}
              {%- render 'html-marketing-grid-product',
                product: block.settings.product,
                show_secondary_image: block.settings.second_image,
                design: block.settings.design,
                block_id: block.id
              -%}
            
            {%- when 'collection' -%}
              {%- render 'html-marketing-grid-collection',
                collection: block.settings.collection,
                show_description: block.settings.show_description,
                design: block.settings.design,
                block_id: block.id
              -%}
          
          {%- endcase -%}
        </div>
      {%- endfor -%}
    </div>
  </div>
</section>

<style>
  .marketing-grid-wrapper {
    
  }
  .marketing-grid-section {
    padding: 4em 0;
    background-color: transparent;
  }
  
  /* Background color variants */
  .marketing-grid-section.has-bg-white {
    background-color: #ffffff;
  }
  
  .marketing-grid-section.has-bg-light-gray {
    background-color: #f5f5f5;
  }
  
  .marketing-grid-section.has-bg-gray {
    background-color: #e5e5e5;
  }
  
  .marketing-grid-section.has-bg-dark {
    background-color: #1a1a1a;
  }
  
  .marketing-grid-section.has-bg-blue {
    background-color: var(--theme-color-blue, #1e40af);
  }
  
  .marketing-grid-section.has-bg-red {
    background-color: var(--theme-color-red, #dc2626);
  }
  
  .marketing-grid-section.has-bg-green {
    background-color: var(--theme-color-green, #16a34a);
  }
  
  /* Adjust text color for dark backgrounds */
  .marketing-grid-section.has-bg-dark .marketing-grid-section__title,
  .marketing-grid-section.has-bg-dark .marketing-grid-section__subtitle,
  .marketing-grid-section.has-bg-blue .marketing-grid-section__title,
  .marketing-grid-section.has-bg-blue .marketing-grid-section__subtitle,
  .marketing-grid-section.has-bg-red .marketing-grid-section__title,
  .marketing-grid-section.has-bg-red .marketing-grid-section__subtitle,
  .marketing-grid-section.has-bg-green .marketing-grid-section__title,
  .marketing-grid-section.has-bg-green .marketing-grid-section__subtitle {
    color: #ffffff;
  }
  
  .marketing-grid-section__inner {
    width: 100%;
  }
  
  .marketing-grid-section__header {
    text-align: center;
    margin-bottom: 2.5em;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }
  
  .marketing-grid-section__title {
    font-size: 2em;
    font-weight: 500;
    margin: 0 0 0.5rem 0;
    line-height: 1.2;
  }
  
  .marketing-grid-section__subtitle {
    font-size: 1em;
    color: #666;
    margin: 0;
    line-height: 1.5;
  }
  
  /* Grid layouts */
  .marketing-grid {
    margin-top: 1.5rem;
    margin-bottom: 1.5rem;
  }
  
  .marketing-grid.is-grid {
    display: grid;
    grid-column-gap: 0.5em;
    grid-row-gap: 0.5em;
    min-height: 500px;
  }
  
  /* No gaps variant */
  .marketing-grid.is-grid.has-no-gaps {
    grid-column-gap: 0;
    grid-row-gap: 0;
  }
  
  /* Grid item wrapper */
  .marketing-grid-item {
    position: relative;
    width: 100%;
    height: 100%;
    min-height: 400px;
  }
  
  /* Make inner components fill the grid item */
  .marketing-grid-item > * {
    width: 100%;
    height: 100%;
  }
  
  /* 3 items - Asymmetric left-heavy */
  .marketing-grid.is-grid.has-items-3 {
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: repeat(2, 1fr);
  }
  
  .marketing-grid.is-grid.has-items-3 > .marketing-grid-item:nth-child(1) {
    grid-area: 1 / 1 / 3 / 2;
  }
  
  .marketing-grid.is-grid.has-items-3 > .marketing-grid-item:nth-child(2) {
    grid-area: 1 / 2 / 2 / 3;
  }
  
  .marketing-grid.is-grid.has-items-3 > .marketing-grid-item:nth-child(3) {
    grid-area: 2 / 2 / 3 / 3;
  }
  
  /* 4 items - Asymmetric with large left */
  .marketing-grid.is-grid.has-items-4 {
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(2, 1fr);
  }
  
  .marketing-grid.is-grid.has-items-4 > .marketing-grid-item:nth-child(1) {
    grid-area: 1 / 1 / 3 / 2;
  }
  
  .marketing-grid.is-grid.has-items-4 > .marketing-grid-item:nth-child(2) {
    grid-area: 1 / 2 / 2 / 3;
  }
  
  .marketing-grid.is-grid.has-items-4 > .marketing-grid-item:nth-child(3) {
    grid-area: 1 / 3 / 2 / 4;
  }
  
  .marketing-grid.is-grid.has-items-4 > .marketing-grid-item:nth-child(4) {
    grid-area: 2 / 2 / 3 / 4;
  }
  
  /* 5 items - Asymmetric with large left */
  .marketing-grid.is-grid.has-items-5 {
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(2, 1fr);
  }
  
  .marketing-grid.is-grid.has-items-5 > .marketing-grid-item:nth-child(1) {
    grid-area: 1 / 1 / 3 / 2;
  }
  
  .marketing-grid.is-grid.has-items-5 > .marketing-grid-item:nth-child(2) {
    grid-area: 1 / 2 / 2 / 3;
  }
  
  .marketing-grid.is-grid.has-items-5 > .marketing-grid-item:nth-child(3) {
    grid-area: 1 / 3 / 2 / 4;
  }
  
  .marketing-grid.is-grid.has-items-5 > .marketing-grid-item:nth-child(4) {
    grid-area: 2 / 2 / 3 / 3;
  }
  
  .marketing-grid.is-grid.has-items-5 > .marketing-grid-item:nth-child(5) {
    grid-area: 2 / 3 / 3 / 4;
  }
  
  /* 1-2 items - Simple layouts */
  .marketing-grid.is-grid.has-items-1 {
    grid-template-columns: 1fr;
    min-height: 600px;
  }
  
  .marketing-grid.is-grid.has-items-2 {
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: 1fr;
  }
  
  /* 6+ items - Regular grid */
  .marketing-grid.is-grid.has-items-6,
  .marketing-grid.is-grid.has-items-7,
  .marketing-grid.is-grid.has-items-8,
  .marketing-grid.is-grid.has-items-9,
  .marketing-grid.is-grid.has-items-10 {
    grid-template-columns: repeat(3, 1fr);
    grid-auto-rows: 1fr;
  }
  
  /* Slider/Flex layout */
  .marketing-grid.is-slider {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    gap: 0.5em;
    overflow-x: auto;
    overflow-y: hidden;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: thin;
    scrollbar-color: rgba(0, 0, 0, 0.3) rgba(0, 0, 0, 0.1);
    height: 30em;
  }
  
  /* No gaps variant for slider */
  .marketing-grid.is-slider.has-no-gaps {
    gap: 0;
  }
  
  .marketing-grid.is-slider::-webkit-scrollbar {
    height: 8px;
  }
  
  .marketing-grid.is-slider::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.1);
    border-radius: 4px;
  }
  
  .marketing-grid.is-slider::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 4px;
  }
  
  .marketing-grid.is-slider::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 0, 0, 0.5);
  }
  
  .marketing-grid.is-slider .marketing-grid-item {
    flex: 0 0 auto;
    width: 400px;
    max-width: 90vw;
    height: 100%;
    scroll-snap-align: start;
  }
  
  /* Responsive */
  @media (max-width: 989px) {
    .marketing-grid-section {
      padding: 2rem 0;
    }
    
    .marketing-grid-section__title {
      font-size: 1.75rem;
    }
    
    .marketing-grid-section__subtitle {
      font-size: 1rem;
    }
    
    /* Tablet: 2 columns for most grids */
    .marketing-grid.is-grid.has-items-4,
    .marketing-grid.is-grid.has-items-5,
    .marketing-grid.is-grid.has-items-6,
    .marketing-grid.is-grid.has-items-7,
    .marketing-grid.is-grid.has-items-8,
    .marketing-grid.is-grid.has-items-9,
    .marketing-grid.is-grid.has-items-10 {
      grid-template-columns: repeat(2, 1fr) !important;
      grid-auto-rows: 1fr;
    }
    
    .marketing-grid.is-grid.has-items-4 > .marketing-grid-item:nth-child(1),
    .marketing-grid.is-grid.has-items-4 > .marketing-grid-item:nth-child(2),
    .marketing-grid.is-grid.has-items-4 > .marketing-grid-item:nth-child(3),
    .marketing-grid.is-grid.has-items-4 > .marketing-grid-item:nth-child(4),
    .marketing-grid.is-grid.has-items-5 > .marketing-grid-item:nth-child(1),
    .marketing-grid.is-grid.has-items-5 > .marketing-grid-item:nth-child(2),
    .marketing-grid.is-grid.has-items-5 > .marketing-grid-item:nth-child(3),
    .marketing-grid.is-grid.has-items-5 > .marketing-grid-item:nth-child(4),
    .marketing-grid.is-grid.has-items-5 > .marketing-grid-item:nth-child(5) {
      grid-area: auto !important;
    }
  }
  
  @media (max-width: 749px) {
    .marketing-grid-section {
      padding: 1.5rem 0;
    }
    
    .marketing-grid-section__header {
      margin-bottom: 1.5rem;
    }
    
    .marketing-grid-section__title {
      font-size: 1.5rem;
    }
    
    .marketing-grid-section__subtitle {
      font-size: 1em;
    }
    
    /* Mobile: Single column for grids */
    .marketing-grid.is-grid {
      grid-template-columns: 1fr !important;
      grid-auto-rows: 1fr;
      min-height: auto;
    }
    
    .marketing-grid.is-grid .marketing-grid-item {
      grid-area: auto !important;
      min-height: 300px;
    }
    
    /* Mobile: Reduce slider item width */
    .marketing-grid.is-slider .marketing-grid-item {
      width: 300px;
    }
  }
</style>

{% schema %}
{
  "name": "Marketing Grid",
  "tag": "section",
  "class": "marketing-grid-wrapper",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured Content"
    },
    {
      "type": "textarea",
      "id": "subtext",
      "label": "Subtext",
      "default": "Discover our curated collection"
    },
    {
      "type": "select",
      "id": "view",
      "label": "Layout",
      "default": "grid",
      "options": [
        {
          "value": "grid",
          "label": "Grid (asymmetric)"
        },
        {
          "value": "slider",
          "label": "Slider/Carousel"
        }
      ],
      "info": "Grid works best with 3-5 items. Slider works for any number."
    },
    {
      "type": "select",
      "id": "background_color",
      "label": "Background color",
      "default": "transparent",
      "options": [
        {
          "value": "transparent",
          "label": "Transparent"
        },
        {
          "value": "white",
          "label": "White"
        },
        {
          "value": "light-gray",
          "label": "Light Gray"
        },
        {
          "value": "gray",
          "label": "Gray"
        },
        {
          "value": "dark",
          "label": "Dark"
        },
        {
          "value": "blue",
          "label": "Blue (Theme)"
        },
        {
          "value": "red",
          "label": "Red (Theme)"
        },
        {
          "value": "green",
          "label": "Green (Theme)"
        }
      ]
    },
    {
      "type": "checkbox",
      "id": "enable_gaps",
      "label": "Enable gaps between items",
      "default": true,
      "info": "Turn off for a seamless, edge-to-edge layout"
    }
  ],
  "blocks": [
    {
      "type": "banner",
      "name": "Banner",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Background image"
        },
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "New Collection",
          "info": "Small badge text (optional)"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Summer Collection"
        },
        {
          "type": "textarea",
          "id": "text",
          "label": "Description"
        },
        {
          "type": "url",
          "id": "link_url",
          "label": "Link URL"
        },
        {
          "type": "select",
          "id": "design",
          "label": "Design style",
          "default": "blue",
          "options": [
            {
              "value": "blue",
              "label": "Blue"
            },
            {
              "value": "red",
              "label": "Red"
            },
            {
              "value": "green",
              "label": "Green"
            }
          ]
        }
      ]
    },
    {
      "type": "video",
      "name": "Video",
      "settings": [
        {
          "type": "video_url",
          "id": "video_url",
          "accept": ["youtube", "vimeo"],
          "default": "https://www.youtube.com/watch?v=_9VUPq3SxOc",
          "label": "Video URL",
          "placeholder": "https://www.youtube.com/watch?v=...",
          "info": "YouTube or Vimeo URL"
        },
        {
          "type": "image_picker",
          "id": "cover_image",
          "label": "Cover image",
          "info": "Shows before video plays"
        },
        {
          "type": "text",
          "id": "description",
          "default": "Video",
          "label": "Video description",
          "info": "For accessibility"
        },
        {
          "type": "select",
          "id": "design",
          "label": "Design style",
          "default": "blue",
          "options": [
            {
              "value": "blue",
              "label": "Blue"
            },
            {
              "value": "red",
              "label": "Red"
            },
            {
              "value": "green",
              "label": "Green"
            }
          ]
        }
      ]
    },
    {
      "type": "product",
      "name": "Product",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Product"
        },
        {
          "type": "checkbox",
          "id": "second_image",
          "default": false,
          "label": "Show second image on hover"
        },
        {
          "type": "select",
          "id": "design",
          "label": "Design style",
          "default": "blue",
          "options": [
            {
              "value": "blue",
              "label": "Blue"
            },
            {
              "value": "red",
              "label": "Red"
            },
            {
              "value": "green",
              "label": "Green"
            }
          ]
        }
      ]
    },
    {
      "type": "collection",
      "name": "Collection",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        },
        {
          "type": "checkbox",
          "id": "show_description",
          "default": true,
          "label": "Show collection description"
        },
        {
          "type": "select",
          "id": "design",
          "label": "Design style",
          "default": "blue",
          "options": [
            {
              "value": "blue",
              "label": "Blue"
            },
            {
              "value": "red",
              "label": "Red"
            },
            {
              "value": "green",
              "label": "Green"
            }
          ]
        }
      ]
    }
  ],
  "max_blocks": 10,
  "presets": [
    {
      "name": "Marketing Grid",
      "category": "Theme Marketing",
      "blocks": [
        {
          "type": "banner"
        },
        {
          "type": "product"
        },
        {
          "type": "collection"
        }
      ]
    }
  ]
}
{% endschema %}
