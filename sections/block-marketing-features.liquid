{%- liquid
	assign has_heading = false
	if section.settings.heading != blank or section.settings.subheading != blank or section.settings.text != blank
		assign has_heading = true
	endif
-%}

<div class="block-marketing-features__content {{ section.settings.width }}{% if section.settings.custom_class != blank %} {{ section.settings.custom_class }}{% endif %}"{% if section.settings.anchor != blank %} id="{{ section.settings.anchor }}"{% endif %}>
	{%- if section.settings.heading != blank -%}
		{%- render 'html-marketing-headline',
			heading: section.settings.heading,
			subheading: section.settings.subheading,
			alignment: 'center'
		-%}
	{%- endif -%}
	
	{%- if section.settings.text != blank -%}
		{%- render 'html-marketing-text',
			text: section.settings.text,
			alignment: 'center',
			width: 'medium'
		-%}
	{%- endif -%}
	
	{%- if section.blocks.size > 0 -%}
		<ul class="block-marketing-features__grid{% if has_heading %} block-marketing-features__grid--has-heading{% endif %}" role="list" style="--grid-columns: {{ section.settings.columns_desktop | default: 3 }}; --grid-columns-tablet: {{ section.settings.columns_tablet | default: 2 }}; --grid-columns-mobile: {{ section.settings.columns_mobile | default: 1 }};">
			{%- for block in section.blocks -%}
				<li class="block-marketing-features__item" {{ block.shopify_attributes }}>
					{%- if block.settings.icon != blank -%}
						<div class="block-marketing-features__icon block-marketing-features__icon--{{ section.settings.icon_style }}">
							{{ block.settings.icon }}
						</div>
					{%- endif -%}
					
					<div class="block-marketing-features__item-content">
						{%- if block.settings.title != blank -%}
							<h3 class="block-marketing-features__item-title">{{ block.settings.title | escape }}</h3>
						{%- endif -%}
						
						{%- if block.settings.description != blank -%}
							<p class="block-marketing-features__item-description">{{ block.settings.description }}</p>
						{%- endif -%}
					</div>
				</li>
			{%- endfor -%}
		</ul>
	{%- endif -%}
</div>

{% style %}
	#shopify-section-{{ section.id }}.block-marketing-features {
		background-color: {{ section.settings.background_color }};
		color: {{ section.settings.text_color }};
		padding-block: {{ section.settings.padding_block }}em;
	}

	#shopify-section-{{ section.id }} .block-marketing-features__grid {
		display: grid;
		grid-template-columns: repeat(var(--grid-columns, 3), 1fr);
		gap: 2em;
		list-style: none;
		margin: 0;
		padding: 0;
	}

	.block-marketing-features__grid--has-heading {
		margin-block-start: 2em;
	}

	.block-marketing-features__item {
		text-align: {{ section.settings.alignment }};
		margin: 0;
	}

	.block-marketing-features__icon {
		width: 64px;
		height: 64px;
		display: flex;
		align-items: center;
		justify-content: center;
		flex-shrink: 0;
		margin-block-end: 1em;
		{%- if section.settings.alignment == 'center' -%}
			margin-inline: auto;
		{%- elsif section.settings.alignment == 'right' -%}
			margin-inline-start: auto;
		{%- endif -%}
	}

	.block-marketing-features__icon svg,
	.block-marketing-features__icon img {
		width: 100%;
		height: 100%;
	}

	.block-marketing-features__icon--circle {
		border-radius: 50%;
		background-color: rgba(0, 0, 0, 0.05);
		padding: 1em;
	}

	.block-marketing-features__icon--square {
		border-radius: 8px;
		background-color: rgba(0, 0, 0, 0.05);
		padding: 1em;
	}

	.block-marketing-features__icon--none {
		background-color: transparent;
		padding: 0;
	}

	.block-marketing-features__item-title {
		font-family: var(--theme-font-family-serif);
		font-size: 1.25em;
		font-weight: 400;
		margin: 0 0 0.5em;
	}

	.block-marketing-features__item-description {
		font-size: 1em;
		line-height: 1.6;
		margin: 0;
		opacity: 0.7;
	}

	@media (max-width: 60em) {
		#shopify-section-{{ section.id }} .block-marketing-features__grid {
			grid-template-columns: repeat(var(--grid-columns-tablet, 2), 1fr);
		}
	}

	@media (max-width: 40em) {
		#shopify-section-{{ section.id }} .block-marketing-features__grid {
			grid-template-columns: repeat(var(--grid-columns-mobile, 1), 1fr);
		}
	}
{% endstyle %}

{% schema %}
{
	"name": "Marketing features",
	"tag": "section",
	"class": "block-marketing-features",
	"disabled_on": {
		"groups": ["header", "footer"]
	},
	"settings": [
		{
			"type": "header",
			"content": "Content"
		},
		{
			"type": "text",
			"id": "heading",
			"label": "Heading"
		},
		{
			"type": "text",
			"id": "subheading",
			"label": "Subheading"
		},
		{
			"type": "richtext",
			"id": "text",
			"label": "Description"
		},
		{
			"type": "header",
			"content": "Layout"
		},
		{
			"type": "select",
			"id": "width",
			"label": "Width",
			"options": [
				{ "value": "is-align-narrow", "label": "Narrow" },
				{ "value": "is-align-small", "label": "Small" },
				{ "value": "is-align", "label": "Regular" },
				{ "value": "is-align-wide", "label": "Wide" },
				{ "value": "is-align-full", "label": "Full" }
			],
			"default": "is-align-wide"
		},
		{
			"type": "range",
			"id": "columns_desktop",
			"label": "Columns (desktop)",
			"min": 1,
			"max": 6,
			"step": 1,
			"default": 3
		},
		{
			"type": "range",
			"id": "columns_tablet",
			"label": "Columns (tablet)",
			"min": 1,
			"max": 4,
			"step": 1,
			"default": 2
		},
		{
			"type": "range",
			"id": "columns_mobile",
			"label": "Columns (mobile)",
			"min": 1,
			"max": 3,
			"step": 1,
			"default": 1
		},
		{
			"type": "select",
			"id": "alignment",
			"label": "Text alignment",
			"options": [
				{ "value": "left", "label": "Left" },
				{ "value": "center", "label": "Center" },
				{ "value": "right", "label": "Right" }
			],
			"default": "center"
		},
		{
			"type": "select",
			"id": "icon_style",
			"label": "Icon style",
			"options": [
				{ "value": "none", "label": "None" },
				{ "value": "circle", "label": "Circle" },
				{ "value": "square", "label": "Square" }
			],
			"default": "circle"
		},
		{
			"type": "range",
			"id": "padding_block",
			"label": "Vertical padding",
			"min": 0,
			"max": 6,
			"step": 0.5,
			"default": 3,
			"unit": "em"
		},
		{
			"type": "header",
			"content": "Colors"
		},
		{
			"type": "color",
			"id": "background_color",
			"label": "Background"
		},
		{
			"type": "color",
			"id": "text_color",
			"label": "Text"
		},
		{
			"type": "header",
			"content": "Advanced"
		},
		{
			"type": "text",
			"id": "anchor",
			"label": "Anchor",
			"info": "ID for scroll links (without #)"
		},
		{
			"type": "text",
			"id": "custom_class",
			"label": "Custom class",
			"info": "Add custom CSS class for styling"
		}
	],
	"blocks": [
		{
			"type": "feature",
			"name": "Feature",
			"settings": [
				{
					"type": "html",
					"id": "icon",
					"label": "Icon (SVG)"
				},
				{
					"type": "text",
					"id": "title",
					"label": "Title"
				},
				{
					"type": "textarea",
					"id": "description",
					"label": "Description"
				}
			]
		}
	],
	"max_blocks": 12,
	"presets": [
		{
			"name": "Features",
			"category": "Marketing",
			"blocks": [
				{ "type": "feature" },
				{ "type": "feature" },
				{ "type": "feature" }
			]
		}
	]
}
{% endschema %}
