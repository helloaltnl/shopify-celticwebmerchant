<section class="block-marketing-features">
  <div class="block-marketing-features__inner alignwide is-constrained">
    {%- if section.settings.heading != blank -%}
      {%- render 'html-marketing-headline',
        heading: section.settings.heading,
        subheading: section.settings.subheading,
        alignment: 'center',
        size: section.settings.heading_size
      -%}
    {%- endif -%}
    
    {%- if section.settings.text != blank -%}
      {%- render 'html-marketing-text',
        text: section.settings.text,
        alignment: 'center',
        width: 'medium'
      -%}
    {%- endif -%}
    
    {%- liquid
      assign features_array = ''
      assign features_array = features_array | split: ','
      
      for block in section.blocks
        assign feature_obj = '{"icon":"' | append: block.settings.icon | append: '","title":"' | append: block.settings.title | append: '","description":"' | append: block.settings.description | append: '"}'
        assign features_array = features_array | concat: feature_obj
      endfor
    -%}
    
    <div class="block-marketing-features__grid">
      {%- for block in section.blocks -%}
        <div class="block-marketing-features__item" {{ block.shopify_attributes }}>
          <div class="feature-item">
            {%- if block.settings.icon != blank -%}
              <div class="feature-item__icon feature-item__icon--{{ section.settings.icon_style }}">
                {{ block.settings.icon }}
              </div>
            {%- endif -%}
            
            <div class="feature-item__content">
              {%- if block.settings.title != blank -%}
                <h3 class="feature-item__title">{{ block.settings.title | escape }}</h3>
              {%- endif -%}
              
              {%- if block.settings.description != blank -%}
                <p class="feature-item__description">{{ block.settings.description }}</p>
              {%- endif -%}
            </div>
          </div>
        </div>
      {%- endfor -%}
    </div>
  </div>
</section>

{%- style -%}
  .block-marketing-features__grid {
    display: grid;
    gap: 2rem;
    margin-top: 3rem;
  }
  
  .block-marketing-features__grid {
    grid-template-columns: repeat({{ section.settings.columns }}, 1fr);
  }
  
  .feature-item {
    text-align: {{ section.settings.alignment }};
  }
  
  .feature-item__icon {
    width: 64px;
    height: 64px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    {% if section.settings.alignment == 'center' %}
      margin: 0 auto 1rem;
    {% elsif section.settings.alignment == 'right' %}
      margin: 0 0 1rem auto;
    {% else %}
      margin: 0 0 1rem 0;
    {% endif %}
  }
  
  .feature-item__icon svg,
  .feature-item__icon img {
    width: 100%;
    height: 100%;
  }
  
  .feature-item__icon--circle {
    border-radius: 50%;
    background-color: #f5f5f5;
    padding: 1rem;
  }
  
  .feature-item__icon--square {
    border-radius: 8px;
    background-color: #f5f5f5;
    padding: 1rem;
  }
  
  .feature-item__icon--none {
    background-color: transparent;
    padding: 0;
  }
  
  .feature-item__title {
    font-size: 1.25rem;
    font-weight: 700;
    margin: 0 0 0.75rem;
  }
  
  .feature-item__description {
    font-size: 1rem;
    line-height: 1.6;
    margin: 0;
    color: #666;
  }
  
  @media (max-width: 989px) {
    .block-marketing-features__grid {
      grid-template-columns: repeat(2, 1fr) !important;
    }
  }
  
  @media (max-width: 749px) {
    .block-marketing-features__grid {
      grid-template-columns: 1fr !important;
    }
  }
{%- endstyle -%}

{% schema %}
{
  "name": "Marketing Features",
  "tag": "section",
  "class": "block-marketing-features",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Our Features"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading"
    },
    {
      "type": "select",
      "id": "heading_size",
      "label": "Heading Size",
      "options": [
        { "value": "small", "label": "Small" },
        { "value": "medium", "label": "Medium" },
        { "value": "large", "label": "Large" }
      ],
      "default": "medium"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Description"
    },
    {
      "type": "range",
      "id": "columns",
      "label": "Columns",
      "min": 2,
      "max": 4,
      "step": 1,
      "default": 3
    },
    {
      "type": "select",
      "id": "alignment",
      "label": "Text Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "icon_style",
      "label": "Icon Style",
      "options": [
        { "value": "circle", "label": "Circle" },
        { "value": "square", "label": "Square" },
        { "value": "none", "label": "None" }
      ],
      "default": "circle"
    }
  ],
  "blocks": [
    {
      "type": "feature",
      "name": "Feature",
      "settings": [
        {
          "type": "html",
          "id": "icon",
          "label": "Icon SVG",
          "info": "Paste SVG code here"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Feature Title"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "Feature description goes here"
        }
      ]
    }
  ],
  "max_blocks": 12,
  "presets": [
    {
      "name": "Marketing Features",
      "category": "Theme Marketing",
      "blocks": [
        {
          "type": "feature",
          "settings": {
            "title": "Fast Shipping",
            "description": "Get your order delivered quickly"
          }
        },
        {
          "type": "feature",
          "settings": {
            "title": "Quality Products",
            "description": "Only the best for our customers"
          }
        },
        {
          "type": "feature",
          "settings": {
            "title": "Easy Returns",
            "description": "Hassle-free return policy"
          }
        }
      ]
    }
  ]
}
{% endschema %}
