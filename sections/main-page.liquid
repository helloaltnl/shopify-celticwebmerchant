{%- comment -%}
============================================================================
MAIN-PAGE
============================================================================
Main section for pages with optional featured image, title and content.
Block-based structure for flexible layout.

FEATURES:
- Hero image with configurable height and focus point
- Page title
- Rich text content

DEPENDENCIES:
- html-theme-icons snippet
============================================================================
{%- endcomment -%}

{%- liquid
	assign is_default_template = false
	if template.suffix == blank
		assign is_default_template = true
	endif
-%}

{%- if is_default_template -%}
<article class="main-page">
	{%- for block in section.blocks -%}
		{%- case block.type -%}

			{%- when 'featured_image' -%}
				{%- if block.settings.image != blank -%}
					<figure class="main-page__hero main-page__hero--{{ block.settings.image_height }}" {{ block.shopify_attributes }}>
						{%- render 'html-theme-media-image',
							image: block.settings.image,
							alt: block.settings.image.alt | default: page.title,
							w1: 600,
							w2: 900,
							w3: 1200,
							w4: 1600,
							w5: 2048,
							sizes: '100vw',
							loading: 'eager',
							fetchpriority: 'high',
							focus_x: block.settings.focus_x,
							focus_y: block.settings.focus_y
						-%}
					</figure>
				{%- endif -%}

			{%- when 'title' -%}
				{%- if page.title != blank -%}
					<header class="main-page__header {{ section.settings.width }}" {{ block.shopify_attributes }}>
						<h1 class="main-page__title">{{ page.title }}</h1>
					</header>
				{%- endif -%}

			{%- when 'content' -%}
				{%- if page.content != blank -%}
					<div class="main-page__content {{ section.settings.width }} rte" {{ block.shopify_attributes }}>
						{{ page.content }}
					</div>
				{%- endif -%}

		{%- endcase -%}
	{%- endfor -%}
</article>
{%- endif -%}

{% style %}
	.main-page {
		padding-bottom: 3em;
	}

	/* Hero Image */
	.main-page__hero {
		width: 100vw;
		margin-left: calc(50% - 50vw);
		margin-right: calc(50% - 50vw);
		padding: 0;
		overflow: hidden;
	}

	.main-page__hero .theme-media__picture {
		width: 100%;
		height: 100%;
	}

	.main-page__hero img,
	.main-page__hero .theme-media__img {
		width: 100%;
		height: 100%;
		object-fit: cover;
	}

	.main-page__hero--adapt {
		aspect-ratio: auto;
	}

	.main-page__hero--adapt .theme-media__picture {
		height: auto;
	}

	.main-page__hero--adapt img,
	.main-page__hero--adapt .theme-media__img {
		height: auto;
	}

	.main-page__hero--small {
		height: 30vh;
	}

	.main-page__hero--medium {
		height: 50vh;
	}

	.main-page__hero--large {
		height: 70vh;
	}

	/* Header */
	.main-page__header {
		padding-top: 2em;
		padding-bottom: 1em;
	}

	.main-page__title {
		font-family: var(--theme-font-family-serif);
		font-size: clamp(2em, 5vw, 3em);
		font-weight: 400;
		line-height: 1.1;
		margin: 0;
	}

	/* Content */
	.main-page__content {
		padding-top: 1em;
		padding-bottom: 2em;
	}
{% endstyle %}

{% schema %}
{
	"name": "Page content",
	"tag": "section",
	"class": "main-page",
	"settings": [
		{
			"type": "header",
			"content": "Layout"
		},
		{
			"type": "select",
			"id": "width",
			"label": "Content width",
			"options": [
				{ "value": "is-align-narrow", "label": "Narrow" },
				{ "value": "is-align-small", "label": "Small" },
				{ "value": "is-align", "label": "Regular" },
				{ "value": "is-align-wide", "label": "Wide" }
			],
			"default": "is-align"
		},
		{
			"type": "header",
			"content": "Howto"
		},
		{
			"type": "paragraph",
			"content": "Default page template. Add blocks to configure layout: featured image, title, content."
		}
	],
	"blocks": [
		{
			"type": "featured_image",
			"name": "Featured image",
			"limit": 1,
			"settings": [
				{
					"type": "image_picker",
					"id": "image",
					"label": "Image"
				},
				{
					"type": "select",
					"id": "image_height",
					"label": "Image height",
					"options": [
						{ "value": "adapt", "label": "Adapt to image" },
						{ "value": "small", "label": "Small" },
						{ "value": "medium", "label": "Medium" },
						{ "value": "large", "label": "Large" }
					],
					"default": "medium"
				},
				{
					"type": "header",
					"content": "Focus point"
				},
				{
					"type": "range",
					"id": "focus_x",
					"label": "Horizontal focus",
					"min": 0,
					"max": 100,
					"step": 5,
					"default": 50,
					"unit": "%"
				},
				{
					"type": "range",
					"id": "focus_y",
					"label": "Vertical focus",
					"min": 0,
					"max": 100,
					"step": 5,
					"default": 50,
					"unit": "%"
				}
			]
		},
		{
			"type": "title",
			"name": "Title",
			"limit": 1
		},
		{
			"type": "content",
			"name": "Content",
			"limit": 1
		}
	]
}
{% endschema %}
