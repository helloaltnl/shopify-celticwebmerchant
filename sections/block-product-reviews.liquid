{%- comment -%}
  ============================================================================
  BLOCK-PRODUCT-REVIEWS
  ============================================================================
  Container section for product review app blocks.

  FEATURES:
  - Renders review app blocks (e.g. Doran, Judge.me)
  - Anchor link support for scroll-to-reviews
  - Width alignment options
  - Color customization
  ============================================================================
{%- endcomment -%}

<div class="block-product-reviews__content {{ section.settings.width }}{% if section.settings.custom_class != blank %} {{ section.settings.custom_class }}{% endif %}"{% if section.settings.anchor != blank %} id="{{ section.settings.anchor }}"{% endif %}>
	{%- for block in section.blocks -%}
		{%- case block.type -%}
			{%- when '@app' -%}
				<div class="block-product-reviews__app" {{ block.shopify_attributes }}>
					{%- render block -%}
				</div>
		{%- endcase -%}
	{%- endfor -%}
</div>

{% style %}
	#shopify-section-{{ section.id }}.block-product-reviews {
		background-color: {{ section.settings.background_color | default: '#f8f8f8' }};
		color: {{ section.settings.text_color | default: '#111111' }};
		padding-block: {% if section.blocks.size > 0 %}{{ section.settings.padding_block }}em{% else %}0{% endif %};
	}

	#shopify-section-{{ section.id }} .block-product-reviews__content {
		scroll-margin-top: 100px;
	}
{% endstyle %}

{% schema %}
{
	"name": "Product reviews",
	"tag": "section",
	"class": "block-product-reviews",
	"enabled_on": {
		"templates": ["product"]
	},
	"settings": [
		{
			"type": "header",
			"content": "Layout"
		},
		{
			"type": "select",
			"id": "width",
			"label": "Width",
			"options": [
				{ "value": "is-align-narrow", "label": "Narrow" },
				{ "value": "is-align-small", "label": "Small" },
				{ "value": "is-align", "label": "Regular" },
				{ "value": "is-align-wide", "label": "Wide" },
				{ "value": "is-align-full", "label": "Full" }
			],
			"default": "is-align"
		},
		{
			"type": "range",
			"id": "padding_block",
			"label": "Vertical padding",
			"min": 0,
			"max": 6,
			"step": 0.5,
			"default": 4,
			"unit": "em"
		},
		{
			"type": "header",
			"content": "Colors"
		},
		{
			"type": "color",
			"id": "background_color",
			"label": "Background"
		},
		{
			"type": "color",
			"id": "text_color",
			"label": "Text"
		},
		{
			"type": "header",
			"content": "Advanced"
		},
		{
			"type": "text",
			"id": "anchor",
			"label": "Anchor",
			"default": "reviews",
			"info": "ID for anchor links (e.g. #reviews)"
		},
		{
			"type": "text",
			"id": "custom_class",
			"label": "Custom class",
			"info": "Add custom CSS class for styling"
		},
		{
			"type": "header",
			"content": "Howto"
		},
		{
			"type": "paragraph",
			"content": "Add reviews app block. Anchor ID is used as scroll target from rating block in product form."
		}
	],
	"blocks": [
		{
			"type": "@app"
		}
	],
	"presets": [
		{
			"name": "Reviews",
			"category": "Product"
		}
	]
}
{% endschema %}
