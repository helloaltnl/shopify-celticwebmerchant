{% comment %}
  HTML Marketing Component: Gallery
  Image grid/carousel
  
  Parameters:
  - images: {Array} Array of image objects (required)
  - layout: {String} grid | carousel - default: grid
  - columns: {String} 2 | 3 | 4 - default: 3 (for grid)
  - gap: {String} small | medium | large - default: medium
  - aspect_ratio: {String} auto | square | landscape | portrait - default: square
  - lightbox: {Boolean} Enable lightbox on click - default: false
{% endcomment %}

{%- liquid
  assign images = images | default: ''
  assign layout = layout | default: 'grid'
  assign columns = columns | default: '3'
  assign gap = gap | default: 'medium'
  assign aspect_ratio = aspect_ratio | default: 'square'
  assign lightbox = lightbox | default: false
-%}

<div class="marketing-gallery marketing-gallery--{{ layout }} marketing-gallery--cols-{{ columns }} marketing-gallery--gap-{{ gap }} marketing-gallery--ratio-{{ aspect_ratio }}">
  {%- if images != blank and images.size > 0 -%}
    <div class="marketing-gallery__grid">
      {%- for image in images -%}
        <div class="marketing-gallery__item">
          {%- if lightbox -%}
            <a href="{{ image | image_url: width: 2000 }}" class="marketing-gallery__link" data-lightbox="gallery">
          {%- endif -%}
          
          <img
            src="{{ image | image_url: width: 800 }}"
            srcset="
              {{ image | image_url: width: 400 }} 400w,
              {{ image | image_url: width: 600 }} 600w,
              {{ image | image_url: width: 800 }} 800w
            "
            sizes="(min-width: 990px) 33vw, (min-width: 750px) 50vw, 100vw"
            alt="{{ image.alt | escape }}"
            width="{{ image.width }}"
            height="{{ image.height }}"
            loading="lazy"
          />
          
          {%- if lightbox -%}
            </a>
          {%- endif -%}
        </div>
      {%- endfor -%}
    </div>
  {%- else -%}
    <div class="marketing-gallery__placeholder">
      <p>Add images to your gallery</p>
    </div>
  {%- endif -%}
</div>

<style>
  .marketing-gallery {
    padding: 2rem 0;
  }
  
  /* Grid layout */
  .marketing-gallery--grid .marketing-gallery__grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  }
  
  .marketing-gallery--grid.marketing-gallery--cols-2 .marketing-gallery__grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .marketing-gallery--grid.marketing-gallery--cols-3 .marketing-gallery__grid {
    grid-template-columns: repeat(3, 1fr);
  }
  
  .marketing-gallery--grid.marketing-gallery--cols-4 .marketing-gallery__grid {
    grid-template-columns: repeat(4, 1fr);
  }
  
  /* Carousel layout */
  .marketing-gallery--carousel .marketing-gallery__grid {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
    gap: 1rem;
  }
  
  .marketing-gallery--carousel .marketing-gallery__item {
    flex: 0 0 80%;
    scroll-snap-align: start;
  }
  
  /* Gap variations */
  .marketing-gallery--gap-small .marketing-gallery__grid {
    gap: 0.5rem;
  }
  
  .marketing-gallery--gap-medium .marketing-gallery__grid {
    gap: 1rem;
  }
  
  .marketing-gallery--gap-large .marketing-gallery__grid {
    gap: 2rem;
  }
  
  /* Item */
  .marketing-gallery__item {
    position: relative;
    overflow: hidden;
  }
  
  .marketing-gallery__item img {
    width: 100%;
    height: 100%;
    display: block;
  }
  
  /* Aspect ratios */
  .marketing-gallery--ratio-square .marketing-gallery__item img {
    aspect-ratio: 1 / 1;
    object-fit: cover;
  }
  
  .marketing-gallery--ratio-landscape .marketing-gallery__item img {
    aspect-ratio: 16 / 9;
    object-fit: cover;
  }
  
  .marketing-gallery--ratio-portrait .marketing-gallery__item img {
    aspect-ratio: 3 / 4;
    object-fit: cover;
  }
  
  /* Link */
  .marketing-gallery__link {
    display: block;
    transition: opacity 0.2s ease;
  }
  
  .marketing-gallery__link:hover {
    opacity: 0.9;
  }
  
  /* Placeholder */
  .marketing-gallery__placeholder {
    background-color: #f5f5f5;
    padding: 4rem 2rem;
    text-align: center;
    color: #666;
  }
  
  /* Responsive */
  @media (max-width: 989px) {
    .marketing-gallery--grid.marketing-gallery--cols-4 .marketing-gallery__grid {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .marketing-gallery--grid.marketing-gallery--cols-3 .marketing-gallery__grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
  
  @media (max-width: 749px) {
    .marketing-gallery--grid.marketing-gallery--cols-2 .marketing-gallery__grid,
    .marketing-gallery--grid.marketing-gallery--cols-3 .marketing-gallery__grid,
    .marketing-gallery--grid.marketing-gallery--cols-4 .marketing-gallery__grid {
      grid-template-columns: 1fr;
    }
  }
</style>
