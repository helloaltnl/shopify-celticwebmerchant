{% comment %}
  HTML Marketing Component: Product Feature
  Single product highlight/showcase
  
  Parameters:
  - product: {Object} Shopify product object (required)
  - heading: {String} Optional custom heading (defaults to product title)
  - text: {String} Optional custom description (defaults to product description)
  - image_position: {String} left | right - default: left
  - show_price: {Boolean} Show product price - default: true
  - show_rating: {Boolean} Show product rating if available - default: false
  - cta_text: {String} Button text - default: "View Product"
{% endcomment %}

{%- liquid
  assign product = product | default: ''
  assign heading = heading | default: ''
  assign text = text | default: ''
  assign image_position = image_position | default: 'left'
  assign show_price = show_price | default: true
  assign show_rating = show_rating | default: false
  assign cta_text = cta_text | default: 'View Product'
-%}

<div class="marketing-product-feature marketing-product-feature--image-{{ image_position }}">
  {%- if product != blank -%}
    <div class="marketing-product-feature__image">
      {%- if product.featured_media -%}
        <a href="{{ product.url }}">
          <img
            src="{{ product.featured_media | image_url: width: 1000 }}"
            srcset="
              {{ product.featured_media | image_url: width: 500 }} 500w,
              {{ product.featured_media | image_url: width: 750 }} 750w,
              {{ product.featured_media | image_url: width: 1000 }} 1000w,
              {{ product.featured_media | image_url: width: 1500 }} 1500w
            "
            sizes="(min-width: 990px) 50vw, 100vw"
            alt="{{ product.featured_media.alt | default: product.title | escape }}"
            width="{{ product.featured_media.width }}"
            height="{{ product.featured_media.height }}"
            loading="lazy"
          />
        </a>
      {%- else -%}
        <div class="marketing-product-feature__placeholder">
          {{ 'product-1' | placeholder_svg_tag }}
        </div>
      {%- endif -%}
    </div>
    
    <div class="marketing-product-feature__content">
      <h2 class="marketing-product-feature__heading">
        <a href="{{ product.url }}">
          {{ heading | default: product.title | escape }}
        </a>
      </h2>
      
      {%- if show_rating and product.metafields.reviews.rating.value != blank -%}
        {%- assign rating = product.metafields.reviews.rating.value -%}
        <div class="marketing-product-feature__rating">
          {%- for i in (1..5) -%}
            <span class="marketing-product-feature__star{% if i <= rating.rating %} marketing-product-feature__star--filled{% endif %}">â˜…</span>
          {%- endfor -%}
          <span class="marketing-product-feature__rating-count">({{ rating.rating_count }})</span>
        </div>
      {%- endif -%}
      
      {%- if show_price -%}
        <div class="marketing-product-feature__price">
          {%- render 'html-product-price',
            product: product,
            show: true,
            from: 'first_available',
            show_compare: true
          -%}
        </div>
      {%- endif -%}
      
      <div class="marketing-product-feature__description">
        {{ text | default: product.description | strip_html | truncatewords: 40 }}
      </div>
      
      <div class="marketing-product-feature__cta">
        {%- render 'html-marketing-cta',
          text: cta_text,
          url: product.url,
          style: 'primary',
          alignment: 'left'
        -%}
      </div>
    </div>
  {%- else -%}
    <div class="marketing-product-feature__placeholder-full">
      <p>Select a product to feature</p>
    </div>
  {%- endif -%}
</div>

<style>
  .marketing-product-feature {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    align-items: center;
    padding: 2rem 0;
  }
  
  /* Image position */
  .marketing-product-feature--image-right .marketing-product-feature__image {
    order: 2;
  }
  
  .marketing-product-feature--image-right .marketing-product-feature__content {
    order: 1;
  }
  
  /* Image */
  .marketing-product-feature__image {
    position: relative;
  }
  
  .marketing-product-feature__image img {
    width: 100%;
    height: auto;
    display: block;
    border-radius: 8px;
  }
  
  .marketing-product-feature__placeholder {
    width: 100%;
    aspect-ratio: 1 / 1;
    background-color: #f5f5f5;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
  }
  
  .marketing-product-feature__placeholder svg {
    width: 50%;
    height: auto;
    opacity: 0.2;
  }
  
  /* Content */
  .marketing-product-feature__content {
    max-width: 600px;
  }
  
  .marketing-product-feature__heading {
    font-size: 2.5rem;
    font-weight: 700;
    margin: 0 0 1rem;
    line-height: 1.2;
  }
  
  .marketing-product-feature__heading a {
    color: inherit;
    text-decoration: none;
  }
  
  .marketing-product-feature__heading a:hover {
    opacity: 0.8;
  }
  
  /* Rating */
  .marketing-product-feature__rating {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
    font-size: 1.125rem;
  }
  
  .marketing-product-feature__star {
    color: #e0e0e0;
  }
  
  .marketing-product-feature__star--filled {
    color: #ffa500;
  }
  
  .marketing-product-feature__rating-count {
    font-size: 0.875rem;
    color: #666;
  }
  
  /* Price */
  .marketing-product-feature__price {
    margin-bottom: 1.5rem;
    font-size: 1.5rem;
    font-weight: 700;
  }
  
  /* Description */
  .marketing-product-feature__description {
    font-size: 1rem;
    line-height: 1.6;
    margin-bottom: 2rem;
    color: #666;
  }
  
  /* CTA */
  .marketing-product-feature__cta {
    margin-top: 2rem;
  }
  
  /* Full placeholder */
  .marketing-product-feature__placeholder-full {
    grid-column: 1 / -1;
    background-color: #f5f5f5;
    padding: 4rem 2rem;
    text-align: center;
    color: #666;
  }
  
  /* Responsive */
  @media (max-width: 989px) {
    .marketing-product-feature {
      grid-template-columns: 1fr;
      gap: 2rem;
    }
    
    .marketing-product-feature--image-right .marketing-product-feature__image,
    .marketing-product-feature--image-right .marketing-product-feature__content {
      order: initial;
    }
    
    .marketing-product-feature__heading {
      font-size: 2rem;
    }
  }
</style>
