{%- comment -%}
  ============================================================================
  HTML-CART-PAYMENTS
  ============================================================================
  Renders cart payment buttons (checkout + additional checkout buttons).

  PARAMETERS:
  - cart: {Object} Cart object (required)
  - show_terms: {Boolean} Show terms text (default: false)
  - terms_text: {String} Terms text with HTML links
  - show_additional_buttons: {Boolean} Show Apple Pay, etc. (default: true)
  - button_text: {String} Custom button text (default: translation)
  - context: {String} 'page' | 'drawer' | 'preview' (default: 'page')

  USAGE:
  {% render 'html-cart-payments', cart: cart, show_terms: true %}
  ============================================================================
{%- endcomment -%}

{%- liquid
  assign show_terms = show_terms | default: false
  if show_additional_buttons == nil
    assign show_additional_buttons = true
  endif
  assign context = context | default: 'page'
  
  # Button text: use translation key if blank, otherwise use custom text
  if button_text == blank
    assign button_label = 'cart.checkout' | t
  else
    # Check if it's a translation key (contains a dot) or custom text
    if button_text contains '.'
      assign button_label = button_text | t
    else
      assign button_label = button_text
    endif
  endif
  
  if terms_text == blank
    assign terms_text = 'cart.terms_html' | t
  endif
-%}

<div class="cart-payments">
  {%- comment -%} Primary Checkout Button {%- endcomment -%}
  <button
    type="submit"
    name="checkout"
    class="cart-payments__checkout is-button is-button--primary"
    data-cart-checkout-button
    {%- if cart.item_count == 0 %}disabled{% endif -%}
  >
    {{ button_label }}
  </button>

  {%- comment -%} Additional Checkout Buttons (Apple Pay, Google Pay, etc.) {%- endcomment -%}
  {%- if show_additional_buttons and additional_checkout_buttons -%}
    <div class="cart-payments__additional additional-checkout-buttons">
      {{ content_for_additional_checkout_buttons }}
    </div>
  {%- endif -%}

  {%- comment -%} Terms and Conditions Text {%- endcomment -%}
  {%- if show_terms -%}
    <div class="cart-payments__terms">
      {{ terms_text }}
    </div>
  {%- endif -%}
</div>

<style>
  .cart-payments {
    padding: 1.5em 0;
  }

  .cart-payments__checkout {
    width: 100%;
    padding: 1em 2em;
    font-size: 1em;
    background-color:var(--theme-color-green)!important;
  }

  .cart-payments__checkout:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .cart-payments__additional {
    margin-top: 1em;
  }

  .cart-payments__terms {
    margin-top: 1.5em;
    padding-top: 0em;
    border-top: 1px solid var(--theme-border-color);
    font-size: 0.85em;
    line-height: 1.6;
    text-align: center;
    opacity: 0.75;
  }

  .cart-payments__terms a {
    color: inherit;
    text-decoration: underline;
  }

  .cart-payments__terms a:hover {
    text-decoration: none;
  }

  /* Compact mode for drawer */
  {% if context == 'drawer' or context == 'preview' %}
  .cart-payments {
    padding: 1em 0;
  }

  .cart-payments__checkout {
    padding: 0.875em 1.5em;
    font-size: 0.9em;
    
  }

  .cart-payments__terms {
    margin-top: 1em;
    padding-top: 1em;
    font-size: 0.8em;
  }
  {% endif %}
</style>
