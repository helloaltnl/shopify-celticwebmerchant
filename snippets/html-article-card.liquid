{%- comment -%}
============================================================================
HTML-ARTICLE-CARD
============================================================================
Reusable article card component for blog articles.

USAGE:
{% render 'html-article-card', article: article %}
{% render 'html-article-card', article: article, layout: 'horizontal', show_blog: true %}

PARAMETERS:
- article: {Article} Article object (required)
- blog_title: {String} Blog title to display (optional)
- layout: {String} 'vertical' | 'horizontal' (default: 'vertical')
- show_image: {Boolean} Show featured image (default: true)
- show_blog: {Boolean} Show blog title label (default: false)
- show_date: {Boolean} Show publish date (default: true)
- show_excerpt: {Boolean} Show article excerpt (default: true)
- show_cta: {Boolean} Show read more link (default: true)
- image_ratio: {String} 'adapt' | 'square' | 'portrait' | 'landscape' (default: 'landscape')
- lazy_load: {Boolean} Lazy load image (default: true)

DEPENDENCIES:
- html-theme-icons snippet
============================================================================
{%- endcomment -%}

{%- liquid
	assign card_layout = layout | default: 'vertical'
	assign image_ratio = image_ratio | default: 'landscape'
	
	comment
		Color defaults - check for blank to handle empty strings
	endcomment
	if card_background == blank
		assign card_background = '#ffffff'
	endif
	if card_text_color == blank
		assign card_text_color = '#111111'
	endif
	
	comment
		Boolean defaults - check for nil to allow false values
	endcomment
	if show_image == nil
		assign show_image = true
	endif
	if show_blog == nil
		assign show_blog = false
	endif
	if show_date == nil
		assign show_date = true
	endif
	if show_excerpt == nil
		assign show_excerpt = true
	endif
	if show_cta == nil
		assign show_cta = true
	endif
	if lazy_load == nil
		assign lazy_load = true
	endif
	
	case image_ratio
		when 'square'
			assign aspect_ratio = '1 / 1'
		when 'portrait'
			assign aspect_ratio = '2 / 3'
		when 'landscape'
			assign aspect_ratio = '3 / 2'
		else
			assign aspect_ratio = 'auto'
	endcase
	
	assign loading_attr = 'lazy'
	if lazy_load == false
		assign loading_attr = 'eager'
	endif
	
	assign card_excerpt = excerpt | default: article.excerpt | default: article.content | strip_html | truncate: 120
-%}

<article class="article-card article-card--{{ card_layout }}" style="--article-card-ratio: {{ aspect_ratio }}; --article-card-bg: {{ card_background }}; --article-card-text: {{ card_text_color }};">
	<a href="{{ article.url }}" class="article-card__link"></a>
	
	{%- if show_image and article.image -%}
		<figure class="article-card__image">
			<img
				src="{{ article.image | image_url: width: 800 }}"
				srcset="
					{{ article.image | image_url: width: 400 }} 400w,
					{{ article.image | image_url: width: 600 }} 600w,
					{{ article.image | image_url: width: 800 }} 800w,
					{{ article.image | image_url: width: 1000 }} 1000w"
				sizes="(min-width: 990px) 25vw, (min-width: 750px) 33vw, 100vw"
				alt="{{ article.image.alt | escape | default: article.title }}"
				loading="{{ loading_attr }}"
				width="{{ article.image.width }}"
				height="{{ article.image.height }}"
			>
		</figure>
	{%- endif -%}

	<div class="article-card__content">
		{%- if show_blog and blog_title != blank -%}
			<span class="article-card__blog">{{ blog_title }}</span>
		{%- endif -%}
		
		<h3 class="article-card__title">{{ article.title }}</h3>

		{%- if show_date -%}
			<time class="article-card__date" datetime="{{ article.published_at | date: '%Y-%m-%d' }}">
				{{ article.published_at | date: format: 'date' }}
			</time>
		{%- endif -%}
		
		{%- if show_excerpt and card_excerpt != blank -%}
			<p class="article-card__excerpt">{{ card_excerpt }}</p>
		{%- endif -%}

		{%- if show_cta -%}
			<span class="article-card__cta">
				<span>{{ 'general.read_more' | t | default: 'Read more' }}</span>
				{%- render 'html-theme-icons', icon: 'arrow', size: 14 -%}
			</span>
		{%- endif -%}
	</div>
</article>

<style>
	.article-card {
		position: relative;
		display: flex;
		width: 100%;
		height: 100%;
		background: var(--article-card-bg, #fff);
		color: var(--article-card-text, #111);
		border: 1px solid var(--theme-color-border, #e5e5e5);
		overflow: hidden;
		transition: box-shadow 200ms ease;
	}

	.article-card--vertical {
		flex-direction: column;
	}

	.article-card--horizontal {
		flex-direction: row;
	}

	.article-card:hover {
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
	}

	.article-card__link {
		position: absolute;
		inset: 0;
		z-index: 1;
	}

	/* Image - Vertical */
	.article-card--vertical .article-card__image {
		margin: 0;
		padding: 0;
		aspect-ratio: var(--article-card-ratio, 3 / 2);
		overflow: hidden;
	}

	/* Image - Horizontal */
	.article-card--horizontal .article-card__image {
		margin: 0;
		padding: 0;
		flex-shrink: 0;
		width: 40%;
		overflow: hidden;
	}

	.article-card__image img {
		width: 100%;
		height: 100%;
		object-fit: cover;
		transition: transform 300ms ease;
	}

	.article-card:hover .article-card__image img {
		transform: scale(1.05);
	}

	/* Content */
	.article-card__content {
		display: flex;
		flex-direction: column;
		flex: 1;
		padding: 1.25em;
	}

	.article-card__blog {
		font-size: 0.75em;
		text-transform: uppercase;
		letter-spacing: 0.05em;
		color: var(--theme-color-accent, #666);
		margin-bottom: 0.5em;
	}

	.article-card__title {
		font-family: var(--theme-font-family-serif);
		font-size: 1.2em;
		font-weight: 500;
		line-height: 1.3;
		margin: 0 0 0.5em;
	}

	.article-card__date {
		font-size: 0.8em;
		opacity: 0.6;
		margin-bottom: 0.75em;
	}

	.article-card__excerpt {
		font-size: 0.9em;
		line-height: 1.5;
		opacity: 0.8;
		margin: 0 0 1em;
	}

	.article-card__cta {
		display: inline-flex;
		align-items: center;
		gap: 0.4em;
		margin-top: auto;
		font-size: 0.9em;
		font-weight: 500;
		color: var(--theme-color-accent, currentColor);
	}

	.article-card__cta svg {
		transition: transform 150ms ease;
	}

	.article-card:hover .article-card__cta svg {
		transform: translateX(0.25em);
	}

	/* Horizontal adjustments */
	.article-card--horizontal .article-card__title {
		font-size: 1.1em;
	}

	.article-card--horizontal .article-card__excerpt {
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	@media (max-width: 749px) {
		.article-card--horizontal {
			flex-direction: column;
		}

		.article-card--horizontal .article-card__image {
			width: 100%;
			aspect-ratio: var(--article-card-ratio, 3 / 2);
		}
	}
</style>
