{% comment %}
  HTML Marketing Component: Image
  Single image with optional caption/link
  
  Parameters:
  - image: {Object} Shopify image object (required)
  - alt: {String} Alt text (optional, falls back to image.alt)
  - caption: {String} Optional caption text
  - link: {String} Optional URL to wrap image
  - width: {String} narrow | medium | wide | full - default: medium
  - alignment: {String} left | center | right - default: center
  - aspect_ratio: {String} auto | square | landscape | portrait - default: auto
{% endcomment %}

{%- liquid
  assign alt = alt | default: image.alt | default: ''
  assign caption = caption | default: ''
  assign link = link | default: ''
  assign width = width | default: 'medium'
  assign alignment = alignment | default: 'center'
  assign aspect_ratio = aspect_ratio | default: 'auto'
-%}

<div class="marketing-image marketing-image--{{ width }} marketing-image--align-{{ alignment }} marketing-image--ratio-{{ aspect_ratio }}">
  <div class="marketing-image__wrapper">
    {%- if link != blank -%}
      <a href="{{ link }}" class="marketing-image__link">
    {%- endif -%}
    
    {%- if image -%}
      <img
        class="marketing-image__img"
        src="{{ image | image_url: width: 1200 }}"
        srcset="
          {{ image | image_url: width: 400 }} 400w,
          {{ image | image_url: width: 600 }} 600w,
          {{ image | image_url: width: 800 }} 800w,
          {{ image | image_url: width: 1200 }} 1200w,
          {{ image | image_url: width: 1600 }} 1600w
        "
        sizes="(min-width: 990px) 800px, 90vw"
        alt="{{ alt | escape }}"
        width="{{ image.width }}"
        height="{{ image.height }}"
        loading="lazy"
      />
    {%- else -%}
      <div class="marketing-image__placeholder">
        {{ 'image' | placeholder_svg_tag: 'marketing-image__placeholder-svg' }}
      </div>
    {%- endif -%}
    
    {%- if link != blank -%}
      </a>
    {%- endif -%}
    
    {%- if caption != blank -%}
      <figcaption class="marketing-image__caption">
        {{ caption | escape }}
      </figcaption>
    {%- endif -%}
  </div>
</div>

<style>
  .marketing-image {
    padding: 1.5rem 0;
  }
  
  .marketing-image__wrapper {
    margin: 0 auto;
  }
  
  /* Width variations */
  .marketing-image--narrow .marketing-image__wrapper {
    max-width: 600px;
  }
  
  .marketing-image--medium .marketing-image__wrapper {
    max-width: 800px;
  }
  
  .marketing-image--wide .marketing-image__wrapper {
    max-width: 1200px;
  }
  
  .marketing-image--full .marketing-image__wrapper {
    max-width: 100%;
  }
  
  /* Alignment */
  .marketing-image--align-left .marketing-image__wrapper {
    margin-left: 0;
    margin-right: auto;
  }
  
  .marketing-image--align-center .marketing-image__wrapper {
    margin-left: auto;
    margin-right: auto;
  }
  
  .marketing-image--align-right .marketing-image__wrapper {
    margin-left: auto;
    margin-right: 0;
  }
  
  /* Image */
  .marketing-image__img {
    display: block;
    width: 100%;
    height: auto;
  }
  
  /* Aspect ratios */
  .marketing-image--ratio-square .marketing-image__img,
  .marketing-image--ratio-landscape .marketing-image__img,
  .marketing-image--ratio-portrait .marketing-image__img {
    object-fit: cover;
    width: 100%;
  }
  
  .marketing-image--ratio-square .marketing-image__img {
    aspect-ratio: 1 / 1;
  }
  
  .marketing-image--ratio-landscape .marketing-image__img {
    aspect-ratio: 16 / 9;
  }
  
  .marketing-image--ratio-portrait .marketing-image__img {
    aspect-ratio: 3 / 4;
  }
  
  /* Link */
  .marketing-image__link {
    display: block;
    transition: opacity 0.2s ease;
  }
  
  .marketing-image__link:hover {
    opacity: 0.9;
  }
  
  /* Caption */
  .marketing-image__caption {
    margin-top: 0.75rem;
    font-size: 0.875rem;
    text-align: center;
    opacity: 0.7;
  }
  
  /* Placeholder */
  .marketing-image__placeholder {
    background-color: #f0f0f0;
    aspect-ratio: 16 / 9;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .marketing-image__placeholder-svg {
    width: 60%;
    height: auto;
    opacity: 0.3;
  }
</style>
